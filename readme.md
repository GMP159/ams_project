# Generative Adversarial Networks for Time Series Synthetic Data Generation to Monitor Energy Consumption of CNC Machines

## Project Description
This project focuses on the generation of synthetic data to model and predict the performance and energy requirements of CNC (Computer Numerical Control) machines. By leveraging the capabilities of Generative Adversarial Networks (GANs), the project aims to simulate realistic data that mirrors the operational patterns of CNC machinery, enabling more robust predictive analytics and enhancing decision-making for future machine maintenance and energy management.

## Dataset:
The dataset contains 22 columns and 19,388 rows, with all values being numerical.
Features (18 columns):

- **Force Parameters:**
  - f_x_sim, f_y_sim, f_z_sim: Simulated force components along the X, Y, and Z axes.  
  - f_sp_sim: Simulated force along the spindle axis.  
- **Moment and Material Removed:**  
  - m_sp_sim: Simulated spindle moment.  
  - materialremoved_sim: Simulated amount of material removed.  
- **Acceleration:**  
  - a_x, a_y, a_z: Acceleration along the X, Y, and Z axes.  
  - a_sp: Acceleration along the spindle axis.  
- **Velocity:**  
  - v_x, v_y, v_z: Velocity along the X, Y, and Z axes.  
  - v_sp: Velocity along the spindle axis.  
- **Position:**  
  - pos_x, pos_y, pos_z: Position coordinates along the X, Y, and Z axes.  
  - pos_sp: Position along the spindle axis.  
- **Current Parameters:**  
  - curr_x, curr_y, curr_z: Current consumption along the X, Y, and Z axes.  
  - curr_sp: Current consumption along the spindle axis.

## Models
**Three distinct GAN architectures were implemented for synthetic data generation:**

**timeGAN**: A GAN variant designed for time-series data, TimeGAN employs a Recurrent Neural Network (RNN)-based architecture, making it well-suited for modeling sequential dependencies and patterns in time-based CNC machine data. This model captures temporal dependencies, providing realistic synthetic datasets that resemble actual CNC machine operation sequences. It is based on this [paper](https://papers.nips.cc/paper_files/paper/2019/hash/c9efe5f26cd17ba6216bbe2a7d26d490-Abstract.html) and codebase was taken from this [repository](https://github.com/jsyoon0823/TimeGAN/tree/master)

**transformerGAN**: Leveraging the powerful Transformer architecture, this GAN is adept at capturing long-range dependencies and intricate data patterns. TransformerGAN provides high-quality synthetic data, especially where complex interactions and dependencies are present, enabling better insights into the nuanced performance characteristics of CNC machines.

**WGAN (Wasserstein GAN):** Known for improved training stability, the WGAN model ensures high-quality synthetic data generation by minimizing the Wasserstein distance, leading to more accurate modeling of CNC machine performance metrics and power consumption data.

## Structure
The repository is organized into three main folders, each includes scripts and modules for training the models, generating synthetic data, and evaluating the outputs.:

  - **time_GAN:** Contains code for the TimeGAN model.
  - **transformer_GAN:** Contains code for the TransformerGAN model.
  - **WGAN:** Contains code for the WGAN (Wasserstein GAN) model.
    

**1. time_GAN**  

**Files:**
  - **data_loading.py:** Script to transform raw time series data to preprocessed normalised time series data.
  - **time_gan.py:** Script to train the model and generate synthetic data using the trained TimeGAN model.
  - **utils.py:** Some utility functions for metrics and timeGAN.
  - **metrics folder:** Contains scripts to evaluate the quality of the synthetic data generated by TimeGAN.
  - **main_timegan.py:** Script to run the model and evaluate it based on metrics.

**How to Run:**
  - Run the following command:
    ```bash
    $ python3 main_timegan.py --data_name stock --seq_len 24 --module gru --hidden_dim 24 --num_layer 3 --iteration 50000 --batch_size 128 --metric_iteration 10 ```
  
  - Command inputs:
    - data_name: sine, stock, or energy
    - seq_len: sequence length
    - module: gru, lstm, or lstmLN
    - hidden_dim: hidden dimensions
    - num_layers: number of layers
    - iterations: number of training iterations
    - batch_size: the number of samples in each batch
    - metric_iterations: number of iterations for metric computation

**2. transformer_GAN**  

**Files:**
  - **dataloader.py:** Script to transform raw time series data to preprocessed normalised time series data.
  - **transformer_model.py:** Script to train the model and generate synthetic data using the trained transformer_GAN model.
  - **metrics folder:** Contains scripts to evaluate the quality of the synthetic data generated by TimeGAN.
  - **main.py:** This script serves as the entry point for the project, orchestrating the entire pipeline for synthetic data generation, evaluation, and visualization.

**How to Run:**
  - Run the following command:
    ```bash
    $ python3 main.py ```

**3. WGAN**  

**Files:**
  - **dataloader.py:** Script to transform raw time series data to preprocessed normalised time series data.
  - **transformer_model.py:** Script that contains the transformer-based GAN architecture.
  - **metrics folder:** Contains scripts to evaluate the quality of the synthetic data generated by TimeGAN.
  - **main.py:** Script to run the model and evaluate it based on metrics.

**How to Run:**
  - Run the following command:
    ```bash
                 ```


## Evaluation
- **Metrics for evaluation**:
  - **Discriminative Score Metric**: Comparison of statistical properties between real and synthetic data. The goal is to compute  how well the discriminator can distinguish between real and synthetic data. The discriminative score is defined as the absolute difference between the classification accuracy and 0.5. An accuracy close to 0.5 indicates that the discriminator cannot distinguish real from synthetic data, which is ideal in a well-trained GAN.
  - **Predictive Score Metric**: Assessment of the ability to predict future machine performance using synthetic data. The predictive score is a critical metric for assessing and validating the effectiveness of generative models, particularly in time-series contexts. It helps ensure that the synthetic data produced is reliable and representative of the original data,
  - **Frechet Inception Distance (FID)**: For assessing the quality of the generated data. It measure the similarity between the real and synthetic datsets.

- **Visual Evaluation**:
  - **PCA (Principal Component Analysis)**
  - **t-SNE (t-distributed Stochastic Neighbor Embedding)**

- **Model Performance Tracking**: We are utilising the weights and biases library to track the performance of our model. With this, we are getting a dashboard with all the evaluation metrics and other performance measures.

## References:

The code is structured into following main components:

model: Contains the transformer-based GAN architecture.
metrics: Implements the evaluation metrics (descriptive, predictive, and Frechet Inception Score).
main: 


To run the project locally, follow these steps:

1. Clone the repository:
   
   git clone <repository-url>
   cd <project-folder>

2. Modify the configuration files if needed (for custom datasets, hyperparameters, etc.).
